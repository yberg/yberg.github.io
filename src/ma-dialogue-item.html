<html><head><link rel="import" href="../bower_components/polymer/polymer-element.html"><link rel="import" href="../bower_components/app-route/app-route.html"><link rel="import" href="../bower_components/paper-card/paper-card.html"><link rel="import" href="../bower_components/paper-radio-button/paper-radio-button.html"><link rel="import" href="../bower_components/paper-radio-group/paper-radio-group.html"><link rel="import" href="../bower_components/paper-checkbox/paper-checkbox.html"><link rel="import" href="../bower_components/paper-input/paper-textarea.html"><link rel="import" href="../bower_components/paper-button/paper-button.html"><link rel="import" href="ma-header-layout.html"><link rel="import" href="ma-dialogue-data.html"><link rel="import" href="ma-spinner.html"><link rel="import" href="ma-animations.html"></head><body><dom-module id="ma-dialogue-item"><template><style>:host{display:flex;flex-direction:column;padding-bottom:66px;--paper-card:{margin:0 8px;padding:8px 0;width:calc(100% - 16px);};}paper-radio-group{@apply --layout-vertical;}paper-radio-button{-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent;}paper-checkbox{display:block;font-size:16px;--paper-checkbox-size:20px;--paper-checkbox-margin:8px;--paper-checkbox-label-spacing:24px;--paper-checkbox-label:{width:calc(100% - (var(--paper-checkbox-size) + var(--paper-checkbox-margin) + var(--paper-checkbox-label-spacing)));};}paper-checkbox + paper-checkbox{margin-top:24px;}ma-header-layout{--ma-header-background-color:transparent;--ma-header-foreground-color:var(--app-primary-color);--ma-header-background-rear-color:white;}.question{margin:0 24px;}footer{display:flex;position:fixed;bottom:0;left:0;width:100%;height:50px;z-index:2;}footer paper-button{flex:1;margin:0;background:#eee;border-radius:0;border:0px solid #ccc;border-top-width:1px;}footer paper-button:not(:first-child){border-left-width:1px;}#responses{position:fixed;display:none;justify-content:center;align-items:center;top:0;left:0;width:100vw;height:100vh;z-index:10;background:rgba(0, 0, 0, .5);}#responsesCard{width:calc(100% - 32px);height:calc(100% - 184px);background:white;color:black;}</style><app-route route="[[route]]" pattern="/:id" tail="{{tail}}" data="{{routeData}}"></app-route><ma-dialogue-data id="dialogueData" item-id="[[routeData.id]]" item="{{item}}"></ma-dialogue-data><ma-spinner loading="{{loading}}"></ma-spinner><ma-header-layout effects="waterfall fade-background" reveals="" back-button="" back-link="dialogue"><div class="question"><h2>[[item.Title]]</h2><h4>[[item.Description]]</h4></div><paper-card id="card" style$="[[_getCardStyle(item)]]"><div class="card-content"><template is="dom-if" if="[[_is(item, 'ChoiceAction')]]"><paper-radio-group selected="{{option}}"><template is="dom-repeat" items="[[item.NotificationOptions]]" as="option"><paper-radio-button name="[[option.Id]]">[[option.Text]]</paper-radio-button></template></paper-radio-group></template><template is="dom-if" if="[[_is(item, 'MultipleChoiceAction')]]"><template is="dom-repeat" items="[[item.NotificationOptions]]" as="option"><paper-checkbox data-id$="[[option.Id]]">[[option.Text]]</paper-checkbox></template></template><template is="dom-if" if="[[_is(item, 'TextAction\,TextMultipleAnswersOption')]]"><paper-textarea label="Svar" value="{{text}}" rows="3"></paper-textarea></template></div></paper-card><footer><paper-button on-tap="_viewResponses">Visa svar</paper-button><paper-button on-tap="_sendResponse">Skicka</paper-button></footer><div id="responses"><paper-card id="responsesCard" elevation="5"></paper-card></div></ma-header-layout></template><script>class MaDialogueItem extends Polymer.Element{static get is(){return'ma-dialogue-item'}static get properties(){return{item:{type:Object,value:()=>({}),observer:'_itemChanged'},option:{type:Number,value:null},active:{type:Boolean,observer:'_activeChanged'},tail:{type:Object,observer:'_tailChanged'},text:{type:String,value:''}}}ready(){super.ready(),this.$.responses.addEventListener('click',(a)=>{this.$.responsesCard.contains(a.target)||this._hideResponses()}),this.$.dialogueData.addEventListener('sent-response',()=>{this.set('text',''),alert('Skickade svar')})}_itemChanged(){this.set('option',null)}_activeChanged(){const{fadeIn:a,slideUp:b}=Animations;this.animate(a.keyframes,a.options),this.$.card.animate(b.keyframes,b.options)}_tailChanged(a){'/responses'===a.path&&this._showResponses()}_viewResponses(){window.history.pushState({},null,`${this.route.prefix}/${this.routeData.id}/responses`),window.dispatchEvent(new CustomEvent('location-changed'))}_sendResponse(){switch(this.item.NotificationType){case'TextAction':case'TextMultipleAnswersOption':this.$.dialogueData.sendTextResponse(this.item.Id,this.text);break;case'ChoiceAction':this.$.dialogueData.sendOptionResponse(this.item.Id,this.option);break;case'MultipleChoiceAction':const a=this.$.card.querySelectorAll('paper-checkbox[checked]'),b=[];for(let c of a)b.push(c.dataset.id);this.$.dialogueData.sendMultiOptionResponse(this.item.Id,b);}}_showResponses(){const{fadeIn:a,slideUp:b}=Animations;this.$.responses.style.display='flex',this.$.responses.animate(a.keyframes,a.options),this.$.responsesCard.animate(b.keyframes,b.options)}_hideResponses(){this.$.responses.style.display='none',window.history.pushState({},null,`${this.route.prefix}/${this.routeData.id}`),window.dispatchEvent(new CustomEvent('location-changed'))}_is(a,b){const c=(b||'').split(',');for(let d of c)if(a&&a.NotificationType===d)return!0;return!1}_getCardStyle(a){return a&&'NoAction'===a.NotificationType?'display: none':''}}window.customElements.define(MaDialogueItem.is,MaDialogueItem);</script></dom-module></body></html>