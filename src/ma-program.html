<html><head><link rel="import" href="../bower_components/polymer/polymer-element.html"><link rel="import" href="../bower_components/iron-icons/iron-icons.html"><link rel="import" href="../bower_components/paper-tabs/paper-tabs.html"><link rel="import" href="../bower_components/paper-ripple/paper-ripple.html"><link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html"><link rel="import" href="../bower_components/iron-ajax/iron-ajax.html"><link rel="import" href="../bower_components/iron-list/iron-list.html"><link rel="import" href="ma-moment.html"><link rel="import" href="ma-program-data.html"><link rel="import" href="ma-spinner.html"><link rel="import" href="shared-styles.html"></head><body><dom-module id="ma-program"><template><style include="shared-styles">:host{--paper-tabs:{background-color:var(--app-primary-color);};--paper-tab:{color:white;};--paper-icon-button:{color:var(--paper-grey-300);};}iron-list{height:calc(100vh - 128px);padding-bottom:16px;}.header,
      .item{background-color:white;font-size:15px;}.header{font-weight:bold;border-top:1px solid #ddd;border-bottom:1px solid #ddd;color:#333;margin-top:16px;padding:16px 16px;}.item{@apply --layout-horizontal;position:relative;}.item:last-child, .item.last{border-bottom:1px solid #ddd;}.item .star{display:flex;align-items:center;padding:0 8px;}.item .content{flex:1 1 auto;padding:16px 16px 16px 0;text-decoration:none;color:black;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent;}paper-icon-button.active{color:var(--paper-amber-500);}</style><ma-program-data program="{{program}}" loading="{{loading}}"></ma-program-data><ma-spinner loading="[[loading]]"></ma-spinner><paper-tabs selected="{{selected}}" scrollable="" fit-container="" class="condense"><paper-tab>Alla</paper-tab><paper-tab>Mitt program</paper-tab></paper-tabs><iron-list items="[[_generateGroups(program.ProgramItems, showAll)]]" as="item" class="condense"><template><div><div class="header" hidden$="[[!_hasGroup(index)]]">[[_format(item.StartDate, 'date')]]</div><div class$="item [[_isLastInGroup(index)]]"><div class="star"><paper-icon-button icon="star" on-click="_toggleFavorite" class$="[[_getStarClass(item.favorite)]]"></paper-icon-button></div><a href="[[rootPath]]program-item/[[item.Id]]" class="content"><strong>[[_format(item.StartDate, 'time')]]</strong><br>[[item.Title]]</a><paper-ripple></paper-ripple></div></div></template></iron-list></template><script>class MaProgram extends Polymer.Element{static get is(){return'ma-program'}static get properties(){return{program:Object,selected:{type:Number,value:0},showAll:{type:Boolean,computed:'_shouldShowAll(selected)'}}}_shouldShowAll(a){return 0===a}_generateGroups(a,b){if(console.log('items',a),!a)return;let c=a.map((a)=>a).filter((a)=>!!b||!!a.favorite),d=[];return this._groupIdxMap=c.reduce((a,b,c,e)=>((0==c||this._format(b.StartDate,'date')!==this._format(e[c-1].StartDate,'date'))&&(a[c]=!0,d.push({start:b.StartDate,index:c})),a),{}),this.dates=d,c}_hasGroup(a){return!0===this._groupIdxMap[a]}_isLastInGroup(a){return this._hasGroup(a+1)?'last':''}_format(a,b){switch(b){case'date':return moment(a).format('dddd, D MMMM YYYY');break;case'time':return moment(a).format('HH:MM');break;default:return moment(a);}}_toggleFavorite(a){let{model:b}=a;b.set('item.favorite',!b.item.favorite)}_getStarClass(a){return a?'active':''}}window.customElements.define(MaProgram.is,MaProgram);</script></dom-module></body></html>